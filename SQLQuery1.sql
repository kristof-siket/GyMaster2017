--ALTER TABLE GYM DROP CONSTRAINT GYM_BOSS;
--ALTER TABLE ATHLETE DROP CONSTRAINT ATHLETE_GYM;
--ALTER TABLE ATHLETE DROP CONSTRAINT FAV_EXERCISE;
--ALTER TABLE RESULT DROP CONSTRAINT ATHLETE_FK;
--ALTER TABLE RESULT DROP CONSTRAINT EXERCISE_FK;
--ALTER TABLE TRAINING_PLAN DROP CONSTRAINT ATHLETE_TP_FK;
IF OBJECT_ID('RESULT', 'U') IS NOT NULL DROP TABLE RESULT;
IF OBJECT_ID('TRAINING_PLAN', 'U') IS NOT NULL DROP TABLE TRAINING_PLAN;
IF OBJECT_ID('ATHLETE', 'U') IS NOT NULL DROP TABLE ATHLETE;
IF OBJECT_ID('EXERCISE', 'U') IS NOT NULL DROP TABLE EXERCISE;
IF OBJECT_ID('GYM', 'U') IS NOT NULL DROP TABLE GYM;


CREATE TABLE GYM 
    (ID             NUMERIC(2) NOT NULL,
     NAME           NVARCHAR(30),
     ADDRESS        NVARCHAR(50),
     TEL 			VARCHAR(16),
     BOSS_ID		NUMERIC(4),

  CONSTRAINT GYM_PRIMARY_KEY PRIMARY KEY (ID));
  
INSERT INTO GYM VALUES (10,'Spárta GYM Óbuda','1037 Budapest, Bécsi út 267', '+36301234567', 1001);
INSERT INTO GYM VALUES (20,'Spárta GYM Zugló','1145 Budapest, Columbus utca 13', '+36308720466', 1002);
INSERT INTO GYM VALUES (30,'Spárta GYM Belváros','1051 Budapest, Zrínyi u. 4', '+36309876543', 1003);


CREATE TABLE ATHLETE 
    (ID             NUMERIC(4) IDENTITY(1001,1),
     NAME           NVARCHAR(30),
     BORN_IN        NVARCHAR(50), --szül. hely
     BORN_DATE      DATE, 
     MEMBER_FROM 	DATE, --tagság kezdete
     HEIGHT		    NUMERIC(3), --cm
     WEIGHT			NUMERIC(3),
     FAV_EXERCISE	NUMERIC(3), -- kedvenc gyakorlat
     GYM_ID			NUMERIC(2),
     IS_PUNISHED	BIT, -- büntetett-e (1 vagy 0, elvileg MS SQL-ben ez a bit a legalkalmasabb)
     IS_TRAINER		BIT, -- edző-e

  CONSTRAINT ATHLETE_PRIMARY_KEY PRIMARY KEY (ID));
  
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Almási Ágnes','Budapest','19850904', '20051126', 172, 62, 100, 20, 0, 0);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Erdei Zsolt','Győr','19720521', '19990506', 170, 80, 200, 10, 0, 1);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Gera Zoltán','Pécs','19790402', '20010305', 178, 72, 300, 30, 0, 0);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Csapó Gábor','Budapest','19750904', '20051126', 172, 62, 200, 20, 0, 0);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Csábi Bettina','Budapest','19750525', '19990506', 170, 60, 100, 10, 0, 1);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Czene Attila','Eger','19800402', '20010305', 178, 80, 100, 30, 0, 0);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Darnyi Tamás','Gyömrő','19890904', '20051126', 183, 84, 100, 20, 0, 0);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Detre Szabolcs','Ipolyvece','19730521', '19990506', 176, 81, 200, 10, 0, 1);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Egerszegi Krisztina','Kishegyes','19870402', '20010305', 171, 58, 300, 30, 0, 0);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Farkas Andrea','Székesfehérvár','19960904', '20051126', 172, 62, 200, 20, 0, 0);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Farkas Péter','Budapest','19740521', '20120506', 176, 80, 200,  10, 0, 1);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Ferling Bernadett','Budapest','19790402', '20060305', 178, 67, 300, 30, 1, 1);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Kásás Tamás','Gyömrő','19890904', '20051126', 183, 84, 200, 20, 0, 0);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Kis Gergő','Balassagyarmat','19790521', '20030506', 176, 81, 200, 10, 0, 1);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Kiss Balázs','Salgótarján','19870402', '20130305', 187, 100, 300, 30, 0, 0);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Kőbán Rita','Székesfehérvár','19960904', '20051126', 172, 62, 100, 20, 0, 0);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Növényi Norbert','Budapest','19630521', '20120506', 176, 80, 100, 10, 0, 1);
INSERT INTO ATHLETE (NAME,BORN_IN,BORN_DATE,MEMBER_FROM,HEIGHT,WEIGHT,FAV_EXERCISE,GYM_ID,IS_PUNISHED,IS_TRAINER) VALUES ('Rubint Réka','Budapest','19790402', '20060305', 170, 54, 200, 30, 1, 1);


CREATE TABLE EXERCISE 
    (ID             NUMERIC(3) NOT NULL,
     NAME           NVARCHAR(20),

  CONSTRAINT EXERCISE_PRIMARY_KEY PRIMARY KEY (ID));
  
INSERT INTO EXERCISE VALUES (100,'Fekvenyomás');
INSERT INTO EXERCISE VALUES (200,'Guggolás');
INSERT INTO EXERCISE VALUES (300,'Felhúzás');


CREATE TABLE RESULT
    (ATHLETE_ID     NUMERIC(4) NOT NULL,
     EX_ID          NUMERIC(3) NOT NULL,
     RES_KG			NUMERIC(3),


  CONSTRAINT RESULT_PRIMARY_KEY PRIMARY KEY (ATHLETE_ID, EX_ID),
  CONSTRAINT ATHLETE_FK FOREIGN KEY (ATHLETE_ID) REFERENCES ATHLETE (ID),
  CONSTRAINT EXERCISE_FK FOREIGN KEY (EX_ID) REFERENCES EXERCISE (ID));

INSERT INTO RESULT VALUES (1003,100,70);
INSERT INTO RESULT VALUES (1003,200,90);
INSERT INTO RESULT VALUES (1003,300,100);
INSERT INTO RESULT VALUES (1004,100,80);
INSERT INTO RESULT VALUES (1004,200,100);
INSERT INTO RESULT VALUES (1004,300,150);
INSERT INTO RESULT VALUES (1005,100,70);
INSERT INTO RESULT VALUES (1005,200,60);
INSERT INTO RESULT VALUES (1005,300,70);
INSERT INTO RESULT VALUES (1006,100,82);
INSERT INTO RESULT VALUES (1006,200,50);
INSERT INTO RESULT VALUES (1006,300,40);
INSERT INTO RESULT VALUES (1007,100,90);
INSERT INTO RESULT VALUES (1007,200,110);
INSERT INTO RESULT VALUES (1007,300,120);
INSERT INTO RESULT VALUES (1008,100,70);
INSERT INTO RESULT VALUES (1008,200,90);
INSERT INTO RESULT VALUES (1008,300,100);
INSERT INTO RESULT VALUES (1009,100,80);
INSERT INTO RESULT VALUES (1009,200,85);
INSERT INTO RESULT VALUES (1009,300,83);
INSERT INTO RESULT VALUES (1010,100,81);
INSERT INTO RESULT VALUES (1010,200,76);
INSERT INTO RESULT VALUES (1010,300,79);


CREATE TABLE TRAINING_PLAN
    (ATHLETE_ID     NUMERIC(4) NOT NULL,
     RELEASE_DATE   DATE NOT NULL, --ugye egy emberhez több terv is tartozhat, de egyszerre csak egyet csinál, tehát ez kell az azonosításhoz
     FILENAME		NVARCHAR(50)

     CONSTRAINT TP_PRIMARY_KEY PRIMARY KEY (ATHLETE_ID, RELEASE_DATE),
     CONSTRAINT ATHLETE_TP_FK FOREIGN KEY (ATHLETE_ID) REFERENCES ATHLETE (ID));

--ide nem szúrunk be kész mezőket, majd a program csinálja ezt.

ALTER TABLE GYM
ADD CONSTRAINT GYM_BOSS FOREIGN KEY (BOSS_ID) REFERENCES ATHLETE (ID);

ALTER TABLE ATHLETE
ADD CONSTRAINT ATHLETE_GYM FOREIGN KEY (GYM_ID) REFERENCES GYM (ID);

ALTER TABLE ATHLETE
ADD CONSTRAINT ATHLETE_FAVEX FOREIGN KEY (FAV_EXERCISE) REFERENCES EXERCISE (ID);